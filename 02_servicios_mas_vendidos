2) SERVICIOS / VEHÍCULOS MÁS VENDIDOS
   (CANTIDAD, MONTO Y RANKING)
========================================================= */
select df.descripcion,
       sum(df.cantidad) as cantidad_vendida,
       sum(df.subtotal_linea) as monto_total,
       rank() over (order by sum(df.cantidad) desc) as ranking_cantidad,
       rank() over (order by sum(df.subtotal_linea) desc) as ranking_monto
from bpanchana.detalle_factura df
     inner join bpanchana.factura f
     on df.id_factura = f.id_factura
where f.estado = 'PAGADA'
  and f.activo = true
  and df.activo = true
group by df.descripcion
order by cantidad_vendida desc;
